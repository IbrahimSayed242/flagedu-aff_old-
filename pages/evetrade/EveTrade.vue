<template>
  <div>
    <div class="bg-eve container-fluid p-0 m-0">
      <div class="row p-0 m-0">
        <img
          class="col-lg-2 col-md-4 col-xs-4 img-logo"
          src="https://res.cloudinary.com/dt9k74vof/image/upload/v1704207698/copy/eva/fdcc36664b876f3643999b7d2c002afd_rhnmui.webp "
        />
      </div>

      <div
        class="row m-5 d-flex justfiy-content-center text-center fw-b"
        dir="rtl"
      >
        <div class="col-lg-6 col-md-6 col-sm-11">
          <h1 class="fw-b">عيش تجربة التداول المثيرة مع</h1>
          <img
            class="col-11"
            src=" https://res.cloudinary.com/dt9k74vof/image/upload/v1704208332/copy/eva/68d41939fa6aa94edba74bcf7bbd26a7_no6zk2.png"
          />

          <img
            class="col-11"
            src=" https://res.cloudinary.com/dt9k74vof/image/upload/v1704208332/copy/eva/f0fd90307a7ef720609c69a41cac2908_ikoavn.png"
          />

          <p class="fs-6">
            مرحبًا بك في [إيفي تريد]، بوابتك الى عالم التداول المالي الذي يفتح
            لك أبواب الفرص والإمكانيات الهائلة. ستجد لدينا منصة تداول متطورة
            تمنحك الأدوات والموارد التي تحتاجها لاتخاذ قرارات مدروسة في ساحة
            الأسواق العالمية
          </p>
          <img
            class="img-award border border-info rounded-3"
            width="500"
            src=" https://res.cloudinary.com/dt9k74vof/image/upload/v1704208332/copy/eva/2126cde56d95b1b1a3fc7501e253de61_trhnhs.png"
          />

          <button
            type="button"
            class="btn btn-info m-3 p-2 fs-3 font-weight-bold rounded-0"
            data-bs-toggle="modal"
            data-bs-target="#exampleModal"
          >
            <<سجل الآن >>
          </button>
        </div>

        <img
          class="col-lg-6 col-md-6 col-sm-11 m-auto"
          src="https://res.cloudinary.com/dt9k74vof/image/upload/v1704207699/copy/eva/15acef12478252e91cbcd15031a200f0_1_zmhcfd.webp"
        />
      </div>

      <div
        class="text-center bg-white px-0 py-3 m-auto d-flex flex-column m-auto justify-content-center"
      >
        <div
          class="col-lg-9 col-md-10 col-sm-8 d-flex flex-column m-auto justify-content-center"
        >
          <img
            class="my-5 d-none d-lg-block d-md-block d-sm-none m-auto"
            src="https://res.cloudinary.com/dt9k74vof/image/upload/v1704210624/copy/eva/eve_iwgz4d.png"
          />
          <img
            class="my-5 d-md-none d-lg-none d-sm-block"
            src="  https://res.cloudinary.com/dt9k74vof/image/upload/v1704267936/copy/eva/eve_brtjhn.webp"
          />
        </div>
        <a
          type="button"
          class="rounded-0 btn btn-info m-3 p-2 fs-3 font-weight-bold col-5 m-auto"
          data-bs-toggle="modal"
          data-bs-target="#exampleModal"
        >
          <<سجل الآن >>
        </a>
      </div>

      <div class="p-0 text-center my-0">
        <img
          class="col-12"
          src="https://res.cloudinary.com/dt9k74vof/image/upload/v1704211374/copy/eva/8ba59ecb7229c8e226d035acac82fac9_ud6tpg.webp"
        />
      </div>
    </div>

    <div class="row mx-5">
      <img
        src="https://res.cloudinary.com/dt9k74vof/image/upload/v1704208367/copy/eva/8e80c159087e48c691210c16bb746ac1_eym1ai.gif"
        class="col-md-5 col-sm-10 m-auto"
      />

      <img
        src="https://res.cloudinary.com/dt9k74vof/image/upload/v1704207701/copy/eva/dd3e609f6a758832cd7cf558a409fdb1_1_ogcyuc.webp"
        class="col-md-6 col-sm-10 m-auto"
      />
    </div>

    <div class="bg-dark d-flex justify-content-center">
      <img
        src="https://res.cloudinary.com/dt9k74vof/image/upload/v1704207697/copy/eva/fab0834341634d9d435bfbc8e6a08763_nfpic7.webp"
        class="m-auto col-3"
      />
    </div>

    <div class="d-flex justify-content-center my-4">
      <img
        src="https://res.cloudinary.com/dt9k74vof/image/upload/v1704207692/copy/eva/b68042b4e647978eb858c0febb9434cc_mvvaes.webp"
        class="m-auto col-9"
      />
    </div>

    <div class="text-center my-3 d-flex flex-column justify-content-center">
      <div class="row d-flex justify-content-center">
        <div class="col-7 my-3">
          <h2 class="text-info fw-b">اتصل بنا</h2>
          <div class="text-center">
            <p>support@eve-invest.com</p>
            <p>Working hours: 9:00 to 18:00 CET</p>
            <p>
              الاتصال بهذا الموقع مؤمن بواسطة بروتوكول المقابس الآمنة س.س.ل ايفي
              تريد هي علامة تجارية مملوكة لشركة TIGER TRADING LIMITED، مرخصة
              لممارسة الوساطة المالية في جزيرة موالي المستقلة، مرخصة ومنظمة من
              قبل هيئة موالي INTERNATIONAL SERVICES AUTHORITY بموجب رقم التسجيل
              [HY00823429].
            </p>
            <p>
              تحذير المخاطر وتنصل قانوني: على الرغم من أن تداول الأسهم المحلية و
              العالمية يمكن أن يكون مربحاً، إلا أنه يتضمن مخاطرة عالية بفقدان
              استثماراتك، خاصة وتزداد المخاطر عند التداول باستخدام الهامش-
              margin. يجب على العملاء اتخاذ العناية الواجبة وتوخي الحذر عند
              اتخاذ قرارات التداول الخاصة بهم. وتقع على عاتق العميل مسؤولية
              التعلم واكتساب المعرفة والخبرة المطلوبة لاستخدام منصة التداول وكل
              ما هو مطلوب للتداول بشكل صحيح. يجب على العملاء أن يعرفوا أن مخاطر
              التداول من الممكن أن تتجاوز مجموع المبالغ المودعة. يجب أن يعرف
              العملاء أيضا أن المعرفة والخبرة لا تستلزم تحقيق الأرباح لأن
              الأسواق يمكن أن تتأثر بعوامل أخرى غير متوقعة قد تؤدي إلى خسائر
              العملاء مثل الأزمات الاقتصادية و / أو السياسية او غيرها. في جميع
              الأحوال، لن نتحمل المسؤولية عن أي قرارات تداول، أو انتهاك للقواعد
              القانونية و / أو اللوائح المعمول بها، او نقص المعرفة و / أو الخبرة
              لدى العميل
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
      dir="rtl"
    >
      <div class="modal-dialog">
        <div class="modal-content bg-d">
          <div class="m-2 p-3">
            <h2 class="text-center m-3">هيا لنبدأ</h2>
            <form @submit.prevent="handleFormSubmit">
              <div class="form-input">
                <input
                  v-model="formData.firstName"
                  type="text"
                  placeholder="الاسم الاول "
                  class="rounded-2 p-2 bg-form2 border-1 border-light"
                />
              </div>
              <div class="form-input">
                <input
                  v-model="formData.lastName"
                  type="text"
                  placeholder="الاسم الاخير "
                  class="rounded-2 p-2 bg-form2 border-1 border-light"
                />
              </div>
              <div class="form-input">
                <label class="text-muted"> هاتف</label>
                <input
                  v-model="formData.phone"
                  type="text"
                  placeholder="+00 000 000 0000"
                  class="rounded-2 p-2 bg-form2 border-1 border-light"
                />
              </div>
              <div class="form-input">
                <label class="text-muted">الايميل</label>
                <input
                  v-model="formData.email"
                  type="email"
                  placeholder="ex: 0C7Zd@example.com"
                  class="rounded-2 p-2 bg-form2 border-1 border-light"
                />
              </div>
              <div class="form-input">
                <label class="text-muted">قسيمة (اختياري)</label>
                <input
                  type="text"
                  placeholder="Coupon (Optional)"
                  class="rounded-2 p-2 bg-form2 border-1 border-light"
                />
              </div>
              <div class="form-input err-msg-container">
                <div
                  class=""
                  v-for="(item, idx) in err_msg"
                  :key="'error_' + idx"
                >
                  * {{ item }}
                </div>
              </div>
              <small class="text-center text-muted col-8"
                >يعني إنشاء حساب أنك توافق على سياسة الخصوصية وتلقي التقارير
                الاقتصادية والمراسلات التسويقية من eve-invest. يمكنك إلغاء
                الاشتراك من القائمة البريدية في أي وقت.
              </small>

              <div class="form-input">
                <button class="btn btn-info px-4" type="submit">تسجيل</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { Component, Vue, Action } from "nuxt-property-decorator";
import { namespaced } from "../../utils/utils";
import { NS_THIRD_PARTY, NS_COMMON } from "../../utils/store/namespace.names";
import {
  EVETRADE_SIGNUP,
  FETCH_CREATIVE_DETAILS,
} from "../../utils/store/action.names";

@Component({
  name: "EveTrade",
  components: {},
  layout: "page-layout",
})
export default class EveTrade extends Vue {
  @Action(namespaced(NS_THIRD_PARTY, EVETRADE_SIGNUP)) eveTradeSignup;
  @Action(namespaced(NS_COMMON, FETCH_CREATIVE_DETAILS)) fetchCreativeDetails;

  formData = {
    firstName: "",
    lastName: "",
    phone: "",
    email: "",
    ci: "",
    uai: "",
    ani: "",
    interest: "EveTrade ",
  };
  err_msg = [];

  handleFormSubmit() {
    this.err_msg = [];

    this.formData["user_ip"] = this.user_ip;
    this.eveTradeSignup(this.formData)
      .then((d) => {
        console.log(d);
        var loginUrl = d.login_url;
        location.href = loginUrl;
        this.$router.push({
          name: "thank-eve",
          query: { redirect_uri: loginUrl },
        });
      })
      .catch((e) => {
        this.err_msg = [];
        if (e.response.status === 400) {
          for (const [key, value] of Object.entries(e.response.data)) {
            this.err_msg.push(value);
          }
        } else {
          var msg = `<div class='t-custom-class'><div>Something went wrong!</div></div>`;
          this.$toast.error(msg);
        }
      });
  }

  async asyncData({ route, $axios, store, error, req }) {
    var user_ip = "104.28.198.135";
    if (process.server) {
      const headers = req && req.headers ? Object.assign({}, req.headers) : {};
      if (headers["x-forwarded-for"]) {
        user_ip = headers["x-forwarded-for"];
      }
    }

    var brand = "evetrade";
    var creative_name = "EveTrade";
    var ci = null;

    const getCreative = await store
      .dispatch(namespaced(NS_COMMON, FETCH_CREATIVE_DETAILS), {
        brand: brand,
        creative_name: creative_name,
      })
      .then((data) => {
        ci = data.id;
      })
      .catch((e) => {});

    return { ci, user_ip };
  }

  mounted() {
    this.formData.ci = this.$route.query.ci ? this.$route.query.ci : null;
    if (!this.formData.ci || this.formData.ci != this.ci) {
      this.formData.ci = this.ci;
    }
    this.formData.uai = this.$route.query.uai ? this.$route.query.uai : null;
    this.formData.ani = this.$route.query.ani ? this.$route.query.ani : null;
  }
}
</script>

<!-- Use preprocessors via the lang attribute! e.g. <style lang="scss"> -->
<style scoped lang="scss">
* {
  font-family: "Readex Pro", sans-serif;
}
.fw-b {
  font-weight: 600 !important;
}
.fw-xb {
  font-weight: 900 !important;
}
.bg-eve {
  width: 100%;

  background-position: center top !important;
  margin: 0px;
  background: linear-gradient(
      rgba(255, 255, 255, 0.35) 0%,
      rgba(255, 255, 255, 0.35) 100%
    ),
    url(https://res.cloudinary.com/dt9k74vof/image/upload/v1704207702/copy/eva/aa35396f1d10bd5568b032f6dda61351_yp2uh3.webp),
    rgba(255, 255, 255, 0);

  background-repeat: no-repeat;
  background-attachment: fixed;
  background-size: cover;
}
form {
  flex-direction: column;
  gap: 15px;
  align-items: center;
  justify-content: center;
  .form-input {
    display: flex;
    flex-direction: column;
    gap: 10px;
    input {
      margin-bottom: 23px;
      height: 35px;
      width: 100%;
      padding-left: 10px;
      color: #141313;
    }
    ::placeholder {
      color: #929292;
      opacity: 1;
    }

    ::-ms-input-placeholder {
      color: #999999;
    }
  }
  .err-msg-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    color: red;
  }
}

.bg-form {
  background: rgba(255, 255, 255, 0.45);
  border-radius: 16px;
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(4.3px);
  -webkit-backdrop-filter: blur(4.3px);
  border: 1px solid rgba(255, 255, 255, 0.38);
}

.bg-form2 {
  background: rgba(255, 255, 255, 0.19);
  border-radius: 16px;
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(4.3px);
  -webkit-backdrop-filter: blur(4.3px);
  border: 1px solid rgba(255, 255, 255, 0.25);
}
.text-s {
  color: #82bb41;
}
.bg-g {
  background-color: #82bb41;
}
img {
  object-fit: contain;
  height: auto;
}
.form-ava {
  position: fixed;
  left: 64px;
}
@media (min-width: 768px) and (max-width: 991.98px) {
  .form-ava {
    position: relative;
  }
}

@media (max-width: 767.98px) {
  .form-ava {
    position: relative;
    left: 0px;
  }
}
.img-logo {
  height: 140px;
}
</style>
